<!DOCTYPE html>
<html lang="fa-ir">
<head>

  <meta charset="utf-8" />

  
  <title>کار با لیست‌ها به صورت برنامه‌نویسی در شیرپوینت</title>

  
  




  
  <meta name="author" content="حامد سعیدی فرد" />
  <meta name="description" content="قبل از شروع لازم است بدانید که ذخیره سازی اطلاعات در شیرپوینت در لیست‌ها و کتابخانه‌ها انجام می‌شود، در لیست‌های رکوردهای اطلاعاتی ذخیره می‌شوند و در کتابخانه‌ها، فایل‌ها را می‌توانید قرار دهید. بقیه امکانات لیست و کتابخانه‌ها مشابه هم هستند. البته شیرپونت تعدادی لیست و کتابخانه پیش فرض دارد مثل لیست تقویم، لیست تماس، لیست پیوند یا کتابخانه تصاویر و کتابخانه اسناد و &amp;hellip; که از آن‌ها هم می‌توانید استفاده کنید، اما عمومی‌ترین نوع لیست در شیرپوینت، لیست سفارشی یا Custom List است که به هر شکلی می‌توانید با آن کار کنید و تنها یک ستون از پیش تعریف شده عنوان دارد و بقیه ستون‌ها را بر حسب نیاز می‌توانید به آن اضافه کنید." />

  
  
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@hamed" />
    <meta name="twitter:title" content="کار با لیست‌ها به صورت برنامه‌نویسی در شیرپوینت" />
    <meta name="twitter:description" content="قبل از شروع لازم است بدانید که ذخیره سازی اطلاعات در شیرپوینت در لیست‌ها و کتابخانه‌ها انجام می‌شود، در لیست‌های رکوردهای اطلاعاتی ذخیره می‌شوند و در کتابخانه‌ها، فایل‌ها را می‌توانید قرار دهید. بقیه امکانات لیست و کتابخانه‌ها مشابه هم هستند. البته شیرپونت تعدادی لیست و کتابخانه پیش فرض دارد مثل لیست تقویم، لیست تماس، لیست پیوند یا کتابخانه تصاویر و کتابخانه اسناد و &amp;hellip; که از آن‌ها هم می‌توانید استفاده کنید، اما عمومی‌ترین نوع لیست در شیرپوینت، لیست سفارشی یا Custom List است که به هر شکلی می‌توانید با آن کار کنید و تنها یک ستون از پیش تعریف شده عنوان دارد و بقیه ستون‌ها را بر حسب نیاز می‌توانید به آن اضافه کنید." />
    <meta name="twitter:image" content="https://elmah.ir/img/sharepoint-logo.png" />
  




<meta name="generator" content="Hugo 0.62.2" />


<link rel="canonical" href="https://elmah.ir/post/36-%DA%A9%D8%A7%D8%B1-%D8%A8%D8%A7-%D9%84%DB%8C%D8%B3%D8%AA-%D9%87%D8%A7-%D8%A8%D9%87-%D8%B5%D9%88%D8%B1%D8%AA-%D8%A8%D8%B1%D9%86%D8%A7%D9%85%D9%87-%D9%86%D9%88%DB%8C%D8%B3%DB%8C-%D8%AF%D8%B1-%D8%B4%DB%8C%D8%B1%D9%BE%D9%88%DB%8C%D9%86%D8%AA/" />
<link rel="alternative" href="https://elmah.ir/index.xml" title="elmah" type="application/atom+xml" />


<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="format-detection" content="telephone=no,email=no,adress=no" />
<meta http-equiv="Cache-Control" content="no-transform" />


<meta name="robots" content="index,follow" />
<meta name="referrer" content="origin-when-cross-origin" />







<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="elmah" />
<meta name="msapplication-tooltip" content="elmah" />
<meta name='msapplication-navbutton-color' content="#5fbf5e" />
<meta name="msapplication-TileColor" content="#5fbf5e" />
<meta name="msapplication-TileImage" content="/img/tile-image-windows.png" />
<link rel="icon" href="https://elmah.ir/img/favicon.ico" />
<link rel="icon" type="image/png" sizes="16x16" href="https://elmah.ir/img/favicon-16x16.png" />
<link rel="icon" type="image/png" sizes="32x32" href="https://elmah.ir/img/favicon-32x32.png" />
<link rel="icon" sizes="192x192" href="https://elmah.ir/img/touch-icon-android.png" />
<link rel="apple-touch-icon" href="https://elmah.ir/img/touch-icon-apple.png" />
<link rel="mask-icon" href="https://elmah.ir/img/safari-pinned-tab.svg" color="#5fbf5e" />



<link rel="stylesheet" href="//cdn.bootcss.com/video.js/6.2.8/alt/video-js-cdn.min.css" />

<link rel="stylesheet" href="https://elmah.ir/css/bundle.css" />
<link rel="stylesheet" href="https://elmah.ir/css/elmah.css" />

  
  <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <script src="//cdn.bootcss.com/video.js/6.2.8/ie8/videojs-ie8.min.js"></script>
  <![endif]-->

<!--[if lte IE 11]>
    <script src="//cdn.bootcss.com/classlist/1.1.20170427/classList.min.js"></script>
  <![endif]-->


<script src="//cdn.bootcss.com/object-fit-images/3.2.3/ofi.min.js"></script>


<script src="//cdn.bootcss.com/smooth-scroll/12.1.4/js/smooth-scroll.polyfills.min.js"></script>


</head>
  <body>
    
    <div class="suspension">
      <a title="Go to top" class="to-top is-hide"><span class="icon icon-up"></span></a>
      
        
      
    </div>
    
    
<header class="site-header">
  <img class="avatar" src="https://avatars1.githubusercontent.com/u/1385656?s=460&amp;v=4" alt="Avatar">
  
  <h2 class="title">elmah</h2>
  
  <p class="subtitle">~ یادداشت‌های یک برنامه‌نویس خوشحال ~</p>
  <button class="menu-toggle" type="button">
    <span class="icon icon-menu"></span>
  </button>
  <nav class="site-menu collapsed">
    <h2 class="offscreen">Main Menu</h2>
    <ul class="menu-list">
      
      
      
      
        <li class="menu-item  is-active"><a href="https://elmah.ir/">صفحه نخست</a></li>
      
        <li class="menu-item "><a href="https://elmah.ir/series/">نوشته‌های دنباله‌دار</a></li>
      
        <li class="menu-item "><a href="https://hameds.github.io/slides/">پرزنت‌های من</a></li>
      
        <li class="menu-item "><a href="https://elmah.ir/about/">درباره من</a></li>
      
    </ul>
  </nav>
  <nav class="social-menu collapsed">
    <h2 class="offscreen">Social Networks</h2>
    <ul class="social-list">

      

      
      <li class="social-item">
        <a href="//github.com/hameds" title="GitHub"><span class="icon icon-github"></span></a>
      </li>

      <li class="social-item">
        <a href="//twitter.com/hamed" title="Twitter"><span class="icon icon-twitter"></span></a>
      </li>

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <li class="social-item">
        <a href="https://elmah.ir/index.xml"><span class="icon icon-rss" title="RSS"></span></a>
      </li>

    </ul>
  </nav>
</header>

<section class="main post-detail">
  <header class="post-header">
    <h1 class="post-title">کار با لیست‌ها به صورت برنامه‌نویسی در شیرپوینت</h1>
    <p class="post-meta">
      @حامد سعیدی فرد ·
      4 دقیقه خواندن</p>
  </header>
  <article class="post-content"><p>قبل از شروع لازم است بدانید که ذخیره سازی اطلاعات در شیرپوینت در لیست‌ها و کتابخانه‌ها انجام می‌شود، در لیست‌های رکوردهای اطلاعاتی ذخیره می‌شوند و در کتابخانه‌ها، فایل‌ها را می‌توانید قرار دهید. بقیه امکانات لیست و کتابخانه‌ها مشابه هم هستند. البته شیرپونت تعدادی لیست و کتابخانه پیش فرض دارد مثل لیست تقویم، لیست تماس، لیست پیوند یا کتابخانه تصاویر و کتابخانه اسناد و &hellip; که از آن‌ها هم می‌توانید استفاده کنید، اما عمومی‌ترین نوع لیست در شیرپوینت، لیست سفارشی یا Custom List است که به هر شکلی می‌توانید با آن کار کنید و تنها یک ستون از پیش تعریف شده عنوان دارد و بقیه ستون‌ها را بر حسب نیاز می‌توانید به آن اضافه کنید.</p>
<p>نکته دیگر که در مطلب کار با سایت‌های شیرپوینت فراموش کردم به آن اشاره کنم، بحث disposable بودن کلاس <code>SPWeb</code> است و بهتر است هنگام استفاده از این کلاس از using استفاده کنید.<br>
ضمناً مانند مثال‌های <a href="https://elmah.ir/post/35-%D9%86%DA%A9%D8%A7%D8%AA%DB%8C-%D8%AF%D8%B1%D8%A8%D8%A7%D8%B1%D9%87-%DA%A9%D8%A7%D8%B1-%D8%A8%D8%A7-%D8%B3%D8%A7%DB%8C%D8%AA-%D9%87%D8%A7-%D8%A8%D9%87-%D8%B5%D9%88%D8%B1%D8%AA-%D8%A8%D8%B1%D9%86%D8%A7%D9%85%D9%87-%D9%86%D9%88%DB%8C%D8%B3%DB%8C-%D8%AF%D8%B1-%D8%B4%DB%8C%D8%B1%D9%BE%D9%88%DB%8C%D9%86%D8%AA/">مطلب قبلی</a>، باز هم به <code>Microsoft.Sharepoint.dll</code> نیاز دارید و البته کدهای نوشته شده در همه نسخه‌های شیرپوینت به یک شکل کار می‌کنند.</p>
<h3 id="اضافه-کردن-لیست-به-یک-سایت-در-شیرپوینت">اضافه کردن لیست به یک سایت در شیرپوینت</h3>
<p>لیست‌ها زیرمجموعه‌ای از یک زیرسایت (کلاس SPWeb) هستند، اگر حتی بخواهید به یک مجموعه سایت لیستی اضافه کنید باید به سایت root آن لیست اضافه کنید. جهت اضافه کردن لیست به سایت از کد زیر می‌توانید استفاده کنید</p>
<script type="application/javascript" src="https://gist.github.com/hameds/a7a515bccc65428f00a24130a190d81f.js"></script>

<p>همان‌طور که در خط highlight شده مشخص است با استفاده از متد Add می‌توانید لیست خود را به سایت مورد نظر اضافه کنید. در مثال بالا لیستی از نوع لیست سفارشی را به سایت اضافه کردیم.</p>
<h3 id="static-name-برای-لیست">Static Name برای لیست</h3>
<p>وقتی در شیرپوینت لیستی یا ستونی را ایجاد می‌کنید، نامی که اولین بار به آن لیست یا ستون می‌دهید به عنوان Static Name محسوب می‌شود، کاربر چنانچه دسترسی لازم را داشته باشد می‌تواند این نام‌ها را هر زمان به دلخواه تغییر دهد. نامی که کاربر برای لیست یا ستون مشاهده می‌کند Display Name نامیده می‌شود. Static Name و Display Name در ابتدای کار ایجاد لیست و ستون یکی هستند ولی بعداً با تعویض نام، متفاوت خواهند بود. در انواع متدهایی که برای کار با لیست‌ها در شیرپوینت وجود دارد عموماً از Display Name استفاده می‌شود. این مساله باعث می‌شود که هنگام کار با لیست‌ها اگر نام آن‌ها توسط کاربر تغییر کرده باشد، برنامه شما به خطا بخورد. راه حل این مساله را در نوشته دیگری بررسی خواهیم کرد.</p>
<h3 id="اضافه-کردن-لیست-به-quick-launch">اضافه کردن لیست به Quick Launch</h3>
<p>وقتی شما از طریق خود UI شیرپوینت لیستی را اضافه می‌کنید گزینه‌ای وجود دارد که می‌توانید مشخص کنید آیا لیست مورد نظر در منو عمودی شیرپوینت که به Quick Lanuch معروف است نمایش داده شود یا خیر. ولی وقتی لیستی را با برنامه‌نویسی در شیرپوینت ایجاد می‌کنید چنین گزینه‌ای وجود ندارد و چنانچه بخواهید لیستی را به Quick Launch اضافه یا از آن حذف کنید باید از property‌ مربوطه یعنی <code>OnQuickLaunch</code> استفاده کنید. به عنوان مثال همان لیست مثال قبلی را در نظر بگیرید. با کد زیر می‌توانیم لیست را به Quick Lanuch اضافه کنیم.</p>
<script type="application/javascript" src="https://gist.github.com/hameds/a89ccda7cc56ebfa2aa8d96aaee5b9de.js"></script>

<p>دقت کنید که در خط 5 برای گرفتن شی مربوط به لیست از Display Name‌ لیست استفاده شده است. همچنین بعد از تغییر یک property شی لیست باید این تغییر را با فراخوانی متد update ذخیره کنیم.</p>
<h3 id="اضافه-کردن-ستون-به-لیست">اضافه کردن ستون به لیست</h3>
<p>شیرپوینت انواع ستون‌های مختلفی را به صورت پیش فرض پشتیبانی می‌کند: ستون‌های از جنس عدد، رشته، تاریخ و &hellip; جهت افزودن ستون به یک لیست شیرپوینت از کد زیر می‌توانید استفاده کنید:</p>
<script type="application/javascript" src="https://gist.github.com/hameds/5ec901fad07861fe052fe3eb93d22a9a.js"></script>

<p>همان‌طور که در خط highlight شده مشخص است در متد <code>Add</code> پارامترهای نام ستون، نوع ستون و اینکه آیا وجود داده برای ستون الزامی است یا خیر را مشخص می‌کنیم. دقت کنید که در این مثال نیازی به استفاده از متد update نیست.</p>
<h3 id="اضافه-کردن-ستون-به-نما">اضافه کردن ستون به نما</h3>
<p>در هر لیست شیرپوینتی می‌توانید view‌ها یا نماهای مختلفی را ایجاد کنید، در هر نما که می‌تواند عمومی یا خصوصی (مخصوص یک کاربر) باشد گزینه‌هایی برای مشخص کردن ستون‌هایی که در آن نما می‌آیند، ترتیب داده‌ها، فیلتر داده‌ها، گروه بندی داده‌ها، صفحه بندی داده‌ها و &hellip; وجود دارد. در واقع اگر لیست‌های شیرپوینت را یک جور فرم‌ساز در نظر بگیریم، نماها را می‌توان گزارش‌ساز در نظر گرفت. موقعی که از طریق خود UI شیرپوینت ستونی را به لیستی اضافه می‌کنید این امکان وجود دارد که مشخص کنید که آیا این ستون‌ به نمای پیش فرض اضافه شود یا خیر. کد زیر ستونی را که در مثال قبل ساختیم به نمای پیش فرض اضافه می‌کند. اگر بخواهیم ستون را به نمای دیگری اضافه کنیم ابتدا باید آن نما را داخل مجموعه نماها که در property مربوطه یعنی Views وجود دارد پیدا کنیم.</p>
<script type="application/javascript" src="https://gist.github.com/hameds/ba89fd577d5376facf86e1e899e52f83.js"></script>

<p>دقت کنید اینجا هم نیاز به استفاده از متد Update برای ذخیره تغییرات وجود دارد. سایر موارد مثل به روز رسانی اطلاعات لیست‌ها یا حذف آن‌ها هم به سادگی از طریق متدها قابل انجام است. در نوشته دیگری عملیات CRUD در لیست‌های شیرپوینت را با هم بررسی خواهیم کرد.</p>
</article>
  <footer class="post-footer">
    
    <p class="post-copyright">
      این
      نوشته <strong>2523</strong> روز پیش منتشر شده و محتوای آن ممکن است برای
      امروز، غیردقیق یا حتی اشتباه باشد. اگر اشتباهی دیدید لطفاً در گیت‌هاب اعلام یا رفعش کنید.
    </p>
  </footer>
  <hr>
  <div id="graphcomment"></div>
  <script type="text/javascript">

     

    
    window.gc_params = {
      graphcomment_id: 'elmah',

      
      fixed_header_height: 0,
    };

     


    (function () {
      var gc = document.createElement('script'); gc.type = 'text/javascript'; gc.async = true;
      gc.src = 'https://graphcomment.com/js/integration.js?' + Math.round(Math.random() * 1e8);
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(gc);
    })();

  </script>

  
  
  
</section>
<footer class="site-footer">
  <p>© 2017-2020 elmah</p>
  <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/laozhu/hugo-nuo" target="_blank">Nuo</a>.</p>
  
</footer>



<script async src="//cdn.bootcss.com/video.js/6.2.8/alt/video.novtt.min.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\[','\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
      extensions: ["AMSmath.js", "AMSsymbols.js"] }
    }
  });
</script>
<script type="text/x-mathjax-config">
  // Fix <code> tags after MathJax finishes running. This is a
  // hack to overcome a shortcoming of Markdown. Discussion at
  // https://github.com/mojombo/jekyll/issues/199
  MathJax.Hub.Queue(() => {
    MathJax.Hub.getAllJax().map(v => v.SourceElement().parentNode.className += ' has-jax');
  });
</script>

<script src="https://elmah.ir/js/bundle.js"></script>




  </body>
</html>
