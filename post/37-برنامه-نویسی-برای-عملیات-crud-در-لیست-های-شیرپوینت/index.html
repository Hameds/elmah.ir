<!DOCTYPE html>
<html lang="fa-ir">
<head>

  <meta charset="utf-8" />

  
  <title>برنامه‌نویسی برای عملیات CRUD در لیست‌های شیرپوینت</title>

  
  




  
  <meta name="author" content="حامد سعیدی فرد" />
  <meta name="description" content="افزودن اطلاعات به لیست شیرپوینت برای افزودن اطلاعات به لیست شیرپوینت از کدی مانند کد زیر استفاده می‌کنیم. در این کد هم همان‌طور که مشاهده می‌کنید بحث استفاده از display name ستون‌ها مطرح است. در کد زیر لیستی داریم که دو ستون Title و Birthday دارد و با کد به آن‌ها مقدار داده‌ایم.
 در کد بالا نکته قابل توجه اول در خط 6 است جایی که ابتدا یک شی از کلاس SPListItem ایجاد کرده‌ایم." />

  
  
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@hamed" />
    <meta name="twitter:title" content="برنامه‌نویسی برای عملیات CRUD در لیست‌های شیرپوینت" />
    <meta name="twitter:description" content="افزودن اطلاعات به لیست شیرپوینت برای افزودن اطلاعات به لیست شیرپوینت از کدی مانند کد زیر استفاده می‌کنیم. در این کد هم همان‌طور که مشاهده می‌کنید بحث استفاده از display name ستون‌ها مطرح است. در کد زیر لیستی داریم که دو ستون Title و Birthday دارد و با کد به آن‌ها مقدار داده‌ایم.
 در کد بالا نکته قابل توجه اول در خط 6 است جایی که ابتدا یک شی از کلاس SPListItem ایجاد کرده‌ایم." />
    <meta name="twitter:image" content="https://elmah.ir/img/sharepoint-logo.png" />
  




<meta name="generator" content="Hugo 0.62.2" />


<link rel="canonical" href="https://elmah.ir/post/37-%D8%A8%D8%B1%D9%86%D8%A7%D9%85%D9%87-%D9%86%D9%88%DB%8C%D8%B3%DB%8C-%D8%A8%D8%B1%D8%A7%DB%8C-%D8%B9%D9%85%D9%84%DB%8C%D8%A7%D8%AA-crud-%D8%AF%D8%B1-%D9%84%DB%8C%D8%B3%D8%AA-%D9%87%D8%A7%DB%8C-%D8%B4%DB%8C%D8%B1%D9%BE%D9%88%DB%8C%D9%86%D8%AA/" />
<link rel="alternative" href="https://elmah.ir/index.xml" title="elmah" type="application/atom+xml" />


<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="format-detection" content="telephone=no,email=no,adress=no" />
<meta http-equiv="Cache-Control" content="no-transform" />


<meta name="robots" content="index,follow" />
<meta name="referrer" content="origin-when-cross-origin" />







<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="elmah" />
<meta name="msapplication-tooltip" content="elmah" />
<meta name='msapplication-navbutton-color' content="#5fbf5e" />
<meta name="msapplication-TileColor" content="#5fbf5e" />
<meta name="msapplication-TileImage" content="/img/tile-image-windows.png" />
<link rel="icon" href="https://elmah.ir/img/favicon.ico" />
<link rel="icon" type="image/png" sizes="16x16" href="https://elmah.ir/img/favicon-16x16.png" />
<link rel="icon" type="image/png" sizes="32x32" href="https://elmah.ir/img/favicon-32x32.png" />
<link rel="icon" sizes="192x192" href="https://elmah.ir/img/touch-icon-android.png" />
<link rel="apple-touch-icon" href="https://elmah.ir/img/touch-icon-apple.png" />
<link rel="mask-icon" href="https://elmah.ir/img/safari-pinned-tab.svg" color="#5fbf5e" />



<link rel="stylesheet" href="//cdn.bootcss.com/video.js/6.2.8/alt/video-js-cdn.min.css" />

<link rel="stylesheet" href="https://elmah.ir/css/bundle.css" />
<link rel="stylesheet" href="https://elmah.ir/css/elmah.css" />

  
  <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <script src="//cdn.bootcss.com/video.js/6.2.8/ie8/videojs-ie8.min.js"></script>
  <![endif]-->

<!--[if lte IE 11]>
    <script src="//cdn.bootcss.com/classlist/1.1.20170427/classList.min.js"></script>
  <![endif]-->


<script src="//cdn.bootcss.com/object-fit-images/3.2.3/ofi.min.js"></script>


<script src="//cdn.bootcss.com/smooth-scroll/12.1.4/js/smooth-scroll.polyfills.min.js"></script>


</head>
  <body>
    
    <div class="suspension">
      <a title="Go to top" class="to-top is-hide"><span class="icon icon-up"></span></a>
      
        
      
    </div>
    
    
<header class="site-header">
  <img class="avatar" src="https://avatars1.githubusercontent.com/u/1385656?s=460&amp;v=4" alt="Avatar">
  
  <h2 class="title">elmah</h2>
  
  <p class="subtitle">~ یادداشت‌های یک برنامه‌نویس خوشحال ~</p>
  <button class="menu-toggle" type="button">
    <span class="icon icon-menu"></span>
  </button>
  <nav class="site-menu collapsed">
    <h2 class="offscreen">Main Menu</h2>
    <ul class="menu-list">
      
      
      
      
        <li class="menu-item  is-active"><a href="https://elmah.ir/">صفحه نخست</a></li>
      
        <li class="menu-item "><a href="https://elmah.ir/series/">نوشته‌های دنباله‌دار</a></li>
      
        <li class="menu-item "><a href="https://hameds.github.io/slides/">پرزنت‌های من</a></li>
      
        <li class="menu-item "><a href="https://elmah.ir/about/">درباره من</a></li>
      
    </ul>
  </nav>
  <nav class="social-menu collapsed">
    <h2 class="offscreen">Social Networks</h2>
    <ul class="social-list">

      

      
      <li class="social-item">
        <a href="//github.com/hameds" title="GitHub"><span class="icon icon-github"></span></a>
      </li>

      <li class="social-item">
        <a href="//twitter.com/hamed" title="Twitter"><span class="icon icon-twitter"></span></a>
      </li>

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <li class="social-item">
        <a href="https://elmah.ir/index.xml"><span class="icon icon-rss" title="RSS"></span></a>
      </li>

    </ul>
  </nav>
</header>

<section class="main post-detail">
  <header class="post-header">
    <h1 class="post-title">برنامه‌نویسی برای عملیات CRUD در لیست‌های شیرپوینت</h1>
    <p class="post-meta">
      @حامد سعیدی فرد ·
      3 دقیقه خواندن</p>
  </header>
  <article class="post-content"><h3 id="افزودن-اطلاعات-به-لیست-شیرپوینت">افزودن اطلاعات به لیست شیرپوینت</h3>
<p>برای افزودن اطلاعات به لیست شیرپوینت از کدی مانند کد زیر استفاده می‌کنیم. در این کد هم همان‌طور که مشاهده می‌کنید بحث استفاده از display name ستون‌ها مطرح است. در کد زیر لیستی داریم که دو ستون Title و Birthday دارد و با کد به آن‌ها مقدار داده‌ایم.</p>
<script type="application/javascript" src="https://gist.github.com/hameds/3e81ecb10b735525b8b78ea60dcb7439.js"></script>

<p>در کد بالا نکته قابل توجه اول در خط 6 است جایی که ابتدا یک شی از کلاس <code>SPListItem</code> ایجاد کرده‌ایم. این شی را با متد <code>Add</code> مقدار داده‌ایم که ممکن است کمی گیج کننده به نظر برسد. واقعیت این است که چون ساختار یک آیتم لیست شیرپوینت می‌تواند به شکل‌های گوناگونی باشد (ستون‌های متفاوتی داشته باشد) استفاده از متد <code>Add</code> کمک می‌کند تا ساختار مربوط به آیتم این لیست خاص (MyList) در شی item در حافظه ایجاد شود. بعداً و مثلاً در خط 7 می‌توانید ستون‌های مختلف این ساختار را مقداردهی کنید.<br>
در خط 9 هم برای ذخیره کردن شی ایجاد شده در حافظه از متد <code>Update</code> استفاده می‌کنیم. از این متد برای ویرایش هم که در ادامه به آن اشاره می‌شود استفاده خواهیم کرد.</p>
<h3 id="خواندن-آیتمهای-لیست-شیرپوینت">خواندن آیتم‌های لیست شیرپوینت</h3>
<p>جهت خواندن آیتم‌های لیست شیرپوینت باید ابتدا آیتم‌های مورد نظر را مشخص کنیم. یک راه استفاده از روش زیر است که تمام آیتم‌های یک لیست را برمی‌گرداند.</p>
<script type="application/javascript" src="https://gist.github.com/hameds/a2d7e63b1bbf2a138e0cfd8e2220fe24.js"></script>

<p>در دنیای واقعی ما باید آیتم‌های مورد نظرمان را پیدا کنیم. برای دریافت یک آیتم خاص از متد <code>GetItemById</code> می‌توانیم استفاده کنیم. راه دیگری هم وجود دارد که استفاده از کوئری‌های CAML است که در مطلب دیگری به آن خواهم پرداخت.</p>
<script type="application/javascript" src="https://gist.github.com/hameds/448362cc96a637b577953fd2042e9169.js"></script>

<p>در کد بالا آیتمی با شناسه 5 را دریافت کرده و محتوای ستون Title آن را در کنسول نوشته‌ایم.</p>
<h3 id="به-روز-رسانی-آیتمهای-لیست-شیرپوینت">به روز رسانی آیتم‌های لیست شیرپوینت</h3>
<p>برای به روز رسانی ابتدا باید آیتم را دریافت و سپس ستون‌های آن را مقداردهی کنیم. مانند مثال زیر:</p>
<script type="application/javascript" src="https://gist.github.com/hameds/95c954283f29293339c0b7336c155658.js"></script>

<p>در مثال بالا آیتمی با شناسه 5 را دریافت و ستون Title آن را به عبارت جدیدی تغییر داده‌ایم. همانطور که مشاهده می‌کنید باز هم از متد Update استفاده کرده‌ایم.</p>
<h3 id="تفاوت-update-و-systemupdate">تفاوت Update و SystemUpdate</h3>
<p>در خط 8 کد بالا از متد update استفاده کرده‌ایم. یک گزینه دیگر استفاده از متد <code>SystemUpdate</code> است. این دو متد تفاوتی اساسی با هم دارند. به صورت کلی در شیرپوینت هر زمان شما آیتمی را اضافه یا ویرایش می‌کنید چند ستون سیستمی مقدار می‌گیرند. ستون‌هایی مثل ایجاد کننده، ویرایش کننده،‌ تاریخ ایجاد، تاریخ آخرین ویرایش. اگر از متد <code>Update</code> استفاده کنید این ستون‌ها مقدار خواهند گرفت و اگر از متد <code>SystemUpdate</code> استفاده کنید مقدار قبلی این ستون‌ها تغییری نمی‌کند. در واقع می‌توانید آیتمی را ویرایش کنید بدون اینکه مثلاً ستون تاریخ ویرایش آن تغییر کند.</p>
<h3 id="تایید-آیتمهای-لیست-شیرپوینت-با-برنامهنویسی">تایید آیتم‌های لیست شیرپوینت با برنامه‌نویسی</h3>
<p>در بعضی لیست‌های شیرپوینت ممکن است پروسه تایید اطلاعات فعال شده باشد. در این جریان هر آیتم می‌تواند شامل سه وضعیت تایید شده، رد شده یا معلق باشد. چنانچه بخواهیم آیتمی را تایید کنیم از کد زیر می‌توان استفاده کرد. در واقع تایید هم نوعی ویرایش ستون در لیست شیرپوینت است.</p>
<script type="application/javascript" src="https://gist.github.com/hameds/58534c207b5952ef0c386f4f8bef7b70.js"></script>

<h3 id="حذف-آیتمها-از-لیست-شیرپوینت">حذف آیتم‌ها از لیست شیرپوینت</h3>
<p>برای حذف با برنامه‌نویسی بعد از دریافت آیتم، خیلی راحت می‌توانیم از متد <code>Delete</code> استفاده کنیم و نیازی به استفاده از متد <code>Update</code> نیست. مانند مثال زیر:</p>
<script type="application/javascript" src="https://gist.github.com/hameds/2ba331cf89a5a42f28a6ca433c8d3d67.js"></script>

<p>در نوشته‌های بعدی مثال‌های کاربردی‌تری از استفاده object model شیرپوینت را با هم بررسی خواهیم کرد.</p>
</article>
  <footer class="post-footer">
    
    <p class="post-copyright">
      این
      نوشته <strong>2522</strong> روز پیش منتشر شده و محتوای آن ممکن است برای
      امروز، غیردقیق یا حتی اشتباه باشد. اگر اشتباهی دیدید لطفاً در گیت‌هاب اعلام یا رفعش کنید.
    </p>
  </footer>
  <hr>
  <div id="graphcomment"></div>
  <script type="text/javascript">

     

    
    window.gc_params = {
      graphcomment_id: 'elmah',

      
      fixed_header_height: 0,
    };

     


    (function () {
      var gc = document.createElement('script'); gc.type = 'text/javascript'; gc.async = true;
      gc.src = 'https://graphcomment.com/js/integration.js?' + Math.round(Math.random() * 1e8);
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(gc);
    })();

  </script>

  
  
  
</section>
<footer class="site-footer">
  <p>© 2017-2020 elmah</p>
  <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/laozhu/hugo-nuo" target="_blank">Nuo</a>.</p>
  
</footer>



<script async src="//cdn.bootcss.com/video.js/6.2.8/alt/video.novtt.min.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\[','\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
      extensions: ["AMSmath.js", "AMSsymbols.js"] }
    }
  });
</script>
<script type="text/x-mathjax-config">
  // Fix <code> tags after MathJax finishes running. This is a
  // hack to overcome a shortcoming of Markdown. Discussion at
  // https://github.com/mojombo/jekyll/issues/199
  MathJax.Hub.Queue(() => {
    MathJax.Hub.getAllJax().map(v => v.SourceElement().parentNode.className += ' has-jax');
  });
</script>

<script src="https://elmah.ir/js/bundle.js"></script>




  </body>
</html>
